# ============================================
# AI Book Backend Environment Configuration
# ============================================
# Copy this file to .env and update with your values
# ============================================

# Environment: development, testing, staging, production
ENVIRONMENT=development
DEBUG=true

# ============================================
# Database Configuration
# ============================================
# For development (SQLite)
DATABASE_URL=sqlite+aiosqlite:///./database/auth.db

# For production (PostgreSQL with asyncpg)
# DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/ai_book

# For production with Neon (recommended)
# DATABASE_URL=postgresql+asyncpg://username:password@ep-name.region.aws.neon.tech/dbname?sslmode=require

# Database connection pool settings
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_AUTO_MIGRATE=true

# ============================================
# JWT Authentication Configuration
# ============================================
# IMPORTANT: Generate a strong, random secret key for production!
# Use: openssl rand -base64 32
JWT_SECRET_KEY=your-super-secure-jwt-secret-key-at-least-32-characters-long
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=10080  # 7 days
JWT_REFRESH_EXPIRE_DAYS=30

# Session configuration
SESSION_EXPIRE_MINUTES=10080  # 7 days
SESSION_COOKIE_NAME=session_id
SESSION_COOKIE_SECURE=false  # Set to true in production with HTTPS
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax

# ============================================
# Email Service Configuration
# ============================================
# Email provider: resend, smtp
EMAIL_SERVICE=smtp

# Resend Configuration (recommended)
# Get API key from https://resend.com/api-keys
RESEND_API_KEY=re_your_resend_api_key_here

# SMTP Configuration (alternative)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_TLS=true
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Email settings
EMAIL_FROM_NAME=AI Book
EMAIL_FROM_ADDRESS=noreply@yourdomain.com

# ============================================
# OAuth Provider Configuration
# ============================================
# Google OAuth 2.0
# Get credentials from https://console.developers.google.com/
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# GitHub OAuth
# Get credentials from https://github.com/settings/applications/new
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# OAuth URLs
AUTH_REDIRECT_URI=http://localhost:3000/auth/callback
FRONTEND_URL=http://localhost:3000

# ============================================
# Security Configuration
# ============================================
# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080,http://localhost:5173
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=*

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPM=60
RATE_LIMIT_RPH=1000

# Password requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true

# Email verification settings
EMAIL_VERIFICATION_REQUIRED=true
EMAIL_VERIFICATION_EXPIRE_MINUTES=1440  # 24 hours
PASSWORD_RESET_EXPIRE_MINUTES=60  # 1 hour

# ============================================
# API Configuration
# ============================================
API_HOST=0.0.0.0
API_PORT=7860
LOG_LEVEL=INFO

# ============================================
# OpenAI Configuration
# ============================================
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# OpenRouter Configuration (fallback)
OPENROUTER_API_KEY=sk-or-v1-your-openrouter-key
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=meta-llama/llama-3.2-3b-instruct:free

# ============================================
# Cache Configuration
# ============================================
CACHE_BACKEND=memory
REDIS_URL=redis://localhost:6379
REDIS_PREFIX=ai_book:
CACHE_DEFAULT_TTL=3600  # 1 hour
CACHE_MEMORY_MAX_SIZE=1000

# ============================================
# Vector Database (Qdrant)
# ============================================
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=your-qdrant-api-key-if-needed

# ============================================
# Content Configuration
# ============================================
BOOK_CONTENT_PATH=./book_content
CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# ============================================
# Chat Configuration
# ============================================
MAX_CONTEXT_MESSAGES=3
CONTEXT_WINDOW_SIZE=4000

# ============================================
# Monitoring Configuration
# ============================================
MONITORING_ENABLED=true
METRICS_ENDPOINT=/metrics
HEALTH_ENDPOINT=/health
TRACK_PERFORMANCE=true
SLOW_QUERY_THRESHOLD=1000

# Sentry error tracking (optional)
SENTRY_DSN=

# ============================================
# Logging Configuration
# ============================================
LOG_FILE_ENABLED=true
LOG_FILE_PATH=logs/app.log
LOG_FILE_ROTATION=1 day
LOG_FILE_RETENTION=30 days
LOG_MAX_FILE_SIZE=100 MB
LOG_JSON_FORMAT=false
LOG_INCLUDE_REQUEST_ID=true
LOG_FILTER_SENSITIVE=true
SENSITIVE_FIELDS=api_key,password,token,authorization,secret

# ============================================
# Feature Flags
# ============================================
FEATURE_EMAIL_VERIFICATION=true
FEATURE_OAUTH_AUTHENTICATION=true
FEATURE_PASSWORD_RESET=true
FEATURE_TWO_FACTOR_AUTH=false
FEATURE_RATE_LIMITING=true
FEATURE_CHAT_HISTORY=true
FEATURE_API_DOCS=true  # Enable API docs in development